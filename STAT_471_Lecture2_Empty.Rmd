---
title: "R Notebook"
output: html_notebook
---
### **For Loops, While Loops, and Custom Functions**

<br>

### **For Loops**
- In math and stats, we have dealt with summations and product iterations in the past.
- We can express sums, products, and any iterative procedures as a loop.
- With sums, addition is "iterated" each time, from a starting index to an ending index.
- You can think of this as how for and while loops work.

```{r}
sum = 0
for (i in 1:10) {
  sum = sum + i
}
sum
```

<br>

### **Example: Sorting a Vector without Built-In Functions**

The idea: To sort a vector, we want to check each pair of successive elements in a vector and compare the greatest value.

The algorithm:  

1. Write a for loop to iterate from the first element to the last "nth" element.  

2. Create another for loop to iterate from the 0th element to the each element that'll be compared next (n-i)th element.  

3. Create an if-else condition block. If the current element is greater than the next element in the vector, swap the elements.

This sorting algorithm is called the "bubble sort algorithm". Here, it sorts the vector in ascending order, but you can switch the conditional sign to sort by descending order.

```{r}
vec = c(49, 62, 3, 21, 9)
n = length(vec)

for (i in 1:(n-1)) {
  for (j in 1:(n-i)) {
    if (vec[j] < vec[j+1]) {
      item = vec[j]
      vec[j] = vec[j+1]
      vec[j+1] = item
    }
  }
}
vec
```

<br>

### **While Loops**

While loops are iterative as well, however they're written differently and the logic is dependent on the conditions you define.

- These conditions are controlled with logical values like TRUE or FALSE.
- For loops automatically end once the maximum number of iterations are reached, while loops may run forever if not ended with a "flag" condition.

### **Example: Printing a Name 5 Times with a Counter**

```{r}
num = 1
while (num < 5) {
  print(num)
  num = num + 1
}
```

<br>

### **Example: Calculating Sum of Elements in a Vector**

```{r}
vec = c(23, 99, 101, 62, 88)
total = 0
n = length(vec)
for (i in 1:n) {
  total = total + vec[i]
}
total
```

<br>

### **Example: Calculating Accuracy of a Machine Learning Model**

Suppose you run your machine learning model on some training data to classify if patients have pneumonia (yes=1) or not (no=0). You want to calculate the accuracy of your model by comparing your predictions with the known data you have. 

- Our predictions are stored in the variable "preds" and our test data values are stored in the variable "test_vals". 

```{r}
preds = c(0, 1, 1, 0, 1, 0, 1, 0, 0, 1)
test_vals = c(0, 0, 1, 1, 1, 0, 1, 1, 0, 1)
```

To compute the accuracy of this model, we count the number of matches in each vector and divide by the total observations we have. We'll write R code to compute the accuracy of our model and round it to two decimal places.

```{r}
acc = 0
pred_size = length(preds)
for (i in 1:pred_size) {
  if (preds[i] == test_vals[i]) {
    acc = acc + 1
  }
}

acc_true = acc / pred_size
acc_true = round(acc_true, 2)
acc_true
```

<br>

### **Functions**

- Functions can organize multiple lines of code if you're handling multiple sub-tasks within a single task.
- Alongside using built-in functions in R, you can write your own custom functions.

<br>

### **Example: Writing a Function to Calculate the Mean and Variance of a Vector**

For this example, we'll use the mean and variance built-in functions. Let's also round our outputs to two decimal places.

```{r}
vec = c(23, 99, 101, 62, 88)

stats_func = function(x) {
  mean_vec = round(mean(x), 2)
  var_vec = round(var(x), 2)
  print(mean_vec)
  print(var_vec)
}

stats_func(vec)
```

<br>

### **Example: Writing a Function to Standardize a Vector**

Recall that when we standardize data, we want to scale each data value as so:

(x - min)/(max - min)

```{r}
vec = c(23, 99, 101, 62, 88)
standardize_vec = function(x) {
  n = length(x)
  for (i in 1:n) {
    x[i] = round((x[i] - min(x)) / (max(x)-min(x)), 2)
  }
  print(x)
}

standardize_vec(vec)
```

<br>

### Data Frames vs. Tibbles

#### R packages

A common point of confusion for new R users is understanding R packages. R packages extend the functionality of R by providing additional functions, datasets, and documentation. These packages are developed by a global community and can be downloaded for free.

```{r}
install.packages("")
library()
data()
```

**A helpful analogy:**
Think of R as a brand-new smartphone. It has basic functionality out of the box, but to do more, you’ll want to download apps. R packages are like these apps.

For example, say you’ve just bought a new phone and want to share a photo on *Instagram* You need to:

1. **Install** the app. 
2. **Open** the app.

Similarly, to use an R package, you must:

1. **Install** the package. 
2. **Load** the package.

Most packages are not installed by default when you install R and RStudio. If you want to use a package for the first time, you must install it first.

Likewise, packages are not automatically loaded when you start RStudio. You’ll need to load each package you want to use every time you start a new R session.

<br>

#### Installing a Package

There are two common ways to install a package in R:

**Option 1: Using the RStudio Interface**

1. Click **Tools → Install Packages**
2. Type the name of the package into the text box.
3. Click **Install**.

**Option 2: Using Code in the Console**

You can also install a package by running the following command in the console:

```{r installing ggplot2, messgae=FALSE}
install.packages("ggplot2")
```

Make sure to include quotation marks around the package name.

<br>

#### Loading a Package

Once you’ve installed a package, you’ll need to load it into your current R session using library() before you can use it.
lp
```{r loading ggplot2}
library(ggplot2)
# or
#library("ggplot2")
```

If the console returns a blinking cursor with no error, the package loaded successfully.

If you see:
`Error in library(ggplot2) : there is no package called ‘ggplot2’`

It means the package was not installed successfully.

<br>

#### Exercise 1

1. Install the following packages: 

   - `dplyr`: Functions for manipulating and transforming data frames.
   
   - `nycflights13`: Dataset of all flights departing from NYC airports (JFK, LGA, EWR) in 2013.
   
   - `knitr`: Functions for generating reports and tables.

2. Load each of these packages using `library()`.

```{r Exercise 1}
#install.packages(c("dplyr", "nycflights13", "knitr"))

library(dplyr)
library(nycflights13)
library(knitr)
```

<br>

#### The Tidyverse Package
The `tidyverse` is a collection of R packages designed for importing, cleaning, transforming, visualizing, and modeling data.

Some core tidyverse packages include:

- `ggplot2`: data visualization
- `dplyr`: data manipulation
- `tidyr`: reshaping and tidying data
- `readr`: importing data
- `tibble`: modern data frames
- `stringr`: working with strings
- `forcats`: working with factors

```{r loading tidyverse}
#install.packages("tidyverse")
library(tidyverse)
```
This will automatically load the core `tidyverse` packages.

<br>

#### Forgetting to Load a Package
You must load a package each time you start RStudio.

If you forget, you might see:
`Error: could not find function`

This means R doesn’t know where the function is because the package isn’t loaded

<br> 

#### R's Traditional `data.frame`

A **data frame** is a list of variables (columns) with the same number of rows, where each row has a unique row name. 

For example, the `cars` data belongs to the class `data.frame`.

```{r}
data(iris)
head(iris)
```

```{r cars data}
#data(cars)

# check type
class(cars)

# column names 
colnames(cars)

# row names
#rownames(cars)

# check dimensions (rows, columns)
dim(cars)

# first rows 
head(cars)

# last rows
tail(cars)
```

<br>

#### Tibbles

**Tibbles** are data frames, but they tweak some older behaviors to make them easier to use.

Two main differences from a classic data frame:

1. **Printing:** Shows only the first 10 rows and all columns that fit on screen, along with each column’s data type.

2. **Subsetting:** Behaves more consistently and avoids partial name matching.

<br>

We can create a tibble using the `cars` dataset:
```{r creating a tibble}
cars_tibble <- as_tibble(cars)
cars_tibble
```
<br> 

#### Subsetting

To extract a single column from a data frame, you can use`$`or `[[ ]]`:
```{r extract for data frame}
# extract by name
cars$speed

# extract by name
cars[["speed"]]

# extract by position
cars[[1]]
```
<br>

The same methods work with tibbles:
```{r extract for tibble}
cars_tibble$speed
cars_tibble[["speed"]]
cars_tibble[[1]]
```
<br>

You can also use the **pipe operator** with `pull()`:

```{r extract using pipe operator}
cars_tibble |> pull(speed)

#cars_tibble %>% pull(speed)
```

The pipe operator (`|>` or `%>%`) is a tool that let's you pass the result of one function directly into the next function, making your code flow more naturally.

<br> 

#### Partial Name Matching

In a **data frame**, R will try to guess the column name if you only type part of it.
```{r}
# data frame will match "spe" to "speed"
#cars$spe
```
<br>

In a **tibble**, R will not guess.
```{r}
#tibble will give a warning
#cars_tibble$spe
```

<br>

#### The `nycflights13` Data

The `nycflights13` package contains five datasets stored in data frames:

1. **flights:** information on all 336,776 flights
2. **airlines:** airline names and IATA codes
3. **planes:** aircraft information
4. **weather:** hourly weather data for NYC airports
5. **airports:**airport names, codes, and locations

We’ll start by exploring the `flights` data frame.

```{r}
library(nycflights13)
flights
```
<br>

#### Exploring Data Frames

There are several ways to explore a data frame in R:

1. `View()`: spreadsheet view of the dataset
2. `glimpse()`: compact overview of all variables and their data types.
3. `kable()`: nicely formatted tables for reports
4. `$`: extraction operator

<br>

#### Exercise 2

1. Use `View()` on flights. What does one row represent?
   a. Data on an airline
   b. Data on a flight ✅
   c. Data on an airport
   d. Data on multiple flights

2. Use `str()` on flights. How many character variables are there?

```{r exercise 2}
view(flights)

str(flights)

#represent airline codes or airport codes 
#represent measurable quantities you can calculate with
```
<br>

#### `glimpse()`

The `glimpse()` function shows:

- The number of rows and columns.
- Each variable's name and data type.
- A preview of the first few values for each variable.

```{r}
glimpse(flights)
```
<br>

#### `kable()`

The `kable()` function from the **knitr** package creates a nicely formatted table of the data.

```{r}
library(knitr)
kable(airlines)
```
<br>

#### `$` operator

The $ operator is a quick way to extract a single column from a data frame.

```{r}
airlines$name
```
We will more often explore data frames using `View()` and `glimpse()`.

<br>

#### Types of Variables

Data frames can contain different types of variables, each serving a specific purpose. Examples include:

- **Identification variables** uniquely identify each observation (e.g., student ID, product serial number).

- **Measurement variables** record numeric values or quantities (e.g., height, exam score).

- **Categorical variables** group observations into categories (e.g., eye color, blood type).

```{r}
glimpse(airports)
```
<br>

#### Help files

R provides built-in help files with documentation for functions, datasets, and other objects. You can access a help file by typing `?` followed by the name of a function or data frame in the **Console**. 

```{r help files}
?flights
```

Whenever you have questions about a function or dataset, make it a habit to check the help file first.

<br>

#### Exercise 3
Using the `airports` dataset:

1. What do the variables `lat`, `lon`, `alt`, `tz`, `dst`, and `tzone` describe? (Hint: check the help file for `airports`.)

2. Name at least three variables where one is an identification variable and the other two are measurement variable.  

3. Extract those three variables from the data frame.

```{r exercise 3}

```

<br> 

#### Other Data Structures

R also includes other data structures such as **lists**, **matrices**, and **arrays**.

We will not cover these as much in this course, but you can read more about them in *Hands-On Programming with R*, Sections 5.3, 5.4, and 5.7.

https://rstudio-education.github.io/hopr/r-objects.html.

<br>
